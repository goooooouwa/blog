---
layout: post
title: 'What is a promise and what is then method?'
categories: diagram javascript Promise
---
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.13 (455674)"/><meta name="keywords" content="diagram, javascript, Promise"/><meta name="altitude" content="39"/><meta name="author" content="Greg Xu"/><meta name="created" content="2013-11-13 13:30:32 +0000"/><meta name="latitude" content="30.52616852303607"/><meta name="longitude" content="114.3383764598722"/><meta name="updated" content="2013-11-14 03:10:05 +0000"/><title>What is a promise and what is then method?</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
<div><span style="color: rgb(51, 51, 51); font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 15px; line-height: 25px; background-color: rgb(255, 255, 255);"><span style="-evernote-last-insertion-point:true;"/>A </span><em style="color: rgb(51, 51, 51); font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 15px; line-height: 25px; background-color: rgb(255, 255, 255);">promise</em><span style="color: rgb(51, 51, 51); font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 15px; line-height: 25px; background-color: rgb(255, 255, 255);"> represents the eventual result of an asynchronous operation. The primary way of interacting with a promise is through its </span><code style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 12px; padding: 0px 5px; border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; white-space: nowrap; color: rgb(51, 51, 51);">then</code><span style="color: rgb(51, 51, 51); font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 15px; line-height: 25px; background-color: rgb(255, 255, 255);"> method, which registers callbacks to receive either a promise's eventual value or the reason why the promise cannot be fulfilled.</span><br/></div>
<div><br/></div>
<div>A <i>promise</i> is any object that has a <i>then</i> method. If a <i>promise</i> has an async process:</div>
<div>
<ul>
<li>when its async process gets a success response, it calls the success callback of its <i>then</i> method, and the <i>promise</i> gets “fulfilled”; </li>
<li>when its async process gets a failure response, it calls the failure callback of its <i>then </i>method, and the <i>promise</i> gets "rejected”.</li>
</ul>
<div>If a promise doesn’t have any async process:</div>
</div>
<div>
<ul>
<li>when it returns, it passes the return value to the success callback of its <i>then</i> method.( jQuery uses the failure callback.)</li>
</ul>
</div>
<div><br/></div>
A <i>then</i> method does four things: 
<div>
<ol>
<li>returns a <i>promise</i> object; </li>
<li>add a success callback and a failure callback to the <i>promise</i> it belongs to; </li>
<li>if the success/ failure callback returns a new <i>promise</i>, then pass the success/ failure response of the new <i>promise</i>'s async process to the corresponding success/ failure callback of the <i>then</i> method that chains after it. Only the new <i>promise</i> has status changed to “fulfilled” or “rejected”, then the current promise gets status changed correspondingly.</li>
<li>if the success/ failure callback does not return a new <i>promise</i>, then pass the return value of its <i>promise</i>'s success/ failure callback to the success callback( jQuery uses the failure callback here) of the <i>then </i>method that chains after it, when the <i>promise </i>it belongs to has status changed to “fulfilled” or “rejected”.</li>
</ol>
<div><br/></div>
<span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);"> either</span><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);"> </span><code style="background-color: rgb(255, 255, 255); font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); max-width: 100%;">onFulfilled</code><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);"> </span><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">or</span><code style="background-color: rgb(255, 255, 255); font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); max-width: 100%;">onRejected</code><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);"> </span><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">returns a value</span><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);"> </span><code style="background-color: rgb(255, 255, 255); font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); max-width: 100%;">x</code><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">, run the Promise Resolution Procedure</span><code style="background-color: rgb(255, 255, 255); font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); max-width: 100%;">[[Resolve]](promise2, x)</code><span style="background-color: rgb(255, 255, 255); font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">. </span></div>
<div><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">The </span><strong style="max-width: 100%; font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">promise resolution procedure</strong><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255); display: inline !important;"><span> </span>is an abstract operation taking as input a promise and a value, which we denote as<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">[[Resolve]](promise, x)</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255); display: inline !important;">.</span> <span style="background-color:rgb(255, 250, 165);-evernote-highlight:true;"><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); display: inline !important;">If </span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">x</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); display: inline !important;"><span> </span>is a thenable, it attempts to make<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">promise</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); display: inline !important;"><span> </span>adopt the state of<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961);">x</code></span><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255); display: inline !important;">, under the assumption that<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">x</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255); display: inline !important;"><span> </span>behaves at least somewhat like a promise. Otherwise, it fulfills<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">promise</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255); display: inline !important;"><span> </span>with the value<span> </span></span><code style="max-width: 100%; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">x</code><span style="font-family: UICTFontTextStyleBody; font-size: 17px; -webkit-tap-highlight-color: rgba(26, 26, 26, 0.301961); background-color: rgb(255, 255, 255);">.</span></div>
</body></html>